{"version":3,"sources":["webpack://FieryData/webpack/universalModuleDefinition","webpack://FieryData/webpack/bootstrap","webpack://FieryData/./src/util.ts","webpack://FieryData/./src/cache.ts","webpack://FieryData/./src/callbacks.ts","webpack://FieryData/./src/stats.ts","webpack://FieryData/./src/data.ts","webpack://FieryData/./src/constants.ts","webpack://FieryData/./src/entry.ts","webpack://FieryData/./src/options.ts","webpack://FieryData/./src/factory/index.ts","webpack://FieryData/./src/operations.ts","webpack://FieryData/./src/index.ts","webpack://FieryData/./src/instance.ts","webpack://FieryData/./src/factory/document.ts","webpack://FieryData/./src/store.ts","webpack://FieryData/./src/pager.ts","webpack://FieryData/./src/factory/map.ts","webpack://FieryData/./src/factory/collection.ts"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isObject","x","toString","isFunction","isString","isArray","Array","isDate","Date","isDefined","isNumber","isFinite","parseDate","toDate","coalesce","a","b","isCollectionSource","source","getFields","fields","otherwise","forEach","iterable","callback","length","prop","isEqual","getTime","constants_1","entry_1","factory_1","stats_1","callbacks_1","getCacheForReference","entry","ref","checkSubs","uid","storeKey","UID_SEPARATOR","path","globalCache","addCacheToEntry","data","options","newDocument","PROP_UID","cache","exists","uses","sub","firstEntry","entries","removed","createRecord","callbacks","onCacheCreate","getCacheForData","removeCacheFromEntry","children","entryIndex","indexOf","splice","inInstance","instance","removeCacheFromInstance","isReferencedSub","onSubDestroy","closeEntry","entrySubs","addSubs","push","checkForDestroy","destroyCache","onCacheDestroy","subProp","hasLiveSub","subOptions","subName","ENTRY_SEPARATOR","subSource","doc","parent","split","PATH_SEPARATOR","pop","collection","subEntry","getEntry","onSubCreate","live","record","defineProperties","recordProperties","destroyGlobalCache","getCacheForDocument","stats","reads","removeDataFromEntry","onInvalidOperation","operation","onUpdate","values","onSet","onDelete","onClear","props","onGetChanges","onRefresh","cachedOnly","onBuild","onCollectionAdd","target","onCollectionRemove","onCollectionModify","onCollectionChanged","onDocumentUpdate","onDocumentMissing","onInstanceCreate","onInstanceDestroy","queries","deletes","updates","sets","writes","util_1","copyData","system","update","setProperty","decodeData","encoded","decode","decoders","parseDocument","out","_a","propValue","id","refreshData","decoded","propExists","propParent","encodeData","explicit","include","exclude","encoders","PROP_VALUE","RECORD_OPTIONS","refresh","sync","save","remove","clear","build","getChanges","options_1","store_1","cache_1","operations","off","index","entryList","cached","getEntryRecordFunctions","excludeSubs","initial","buildSub","createSub","fieldsOrEquality","equalityOrNothing","getEntryRecordProperties","recordFunctions","recordOptions","optionsInput","namedSource","getOptions","getStoreKey","existing","recycleOptions","sources","updatePointers","querySnapshot","docs","first","last","docChanges","performMerge","defaults","mergeOptions","optionsProp","merger","globalOptions","defined","user","undefined","onError","message","onMissing","onSuccess","results","onRemove","onMutate","mutate","liveOptions","map","getOptionsByKey","parseInt","extends","shared","type","typeConstructor_1","newCollection","excludeMap","timestamps","decoders_1","timestamp","nameOrMap","namedOptions","setGlobalOptions","mergeStrategy","ignore","replace","chain","apply","arguments","shallow","__assign","concat","union","added","exclusions_1","defaultsArray_1","optionsArray_1","vm","query","once","nullifyMissing","onceOptions","document_1","map_1","collection_1","where","default","data_1","pager_1","_this","delete","Promise","reject","buildFromCollection","defaultValue","pager","entryFor","getPager","system_1","then","options_2","values_1","createValues","set","propsArray","ref_1","store","firestore","promises_1","deleting","deleteCount","_i","propsArray_1","firebaseRuntime","app","firebase_","FieldValue","all","equality_1","options_3","current_1","remote","local","changed","remoteValue","localValue","resolve","ref_2","built","instance_1","getInstance","__export","destroy","opt","free","linkSources","container","systemOverrides","defaultSystem","systemProp","buildSystem","removeNamed","removeProperty","arraySet","arrayAdd","arrayResize","size","initialTarget","missingSynchronously","onSnapshot","handleDocumentUpdate","promise","catch","_resolve","_reject","reason","stores","keyNext","idToKey","pointer","hasQuery","requery","hasData","hasNext","hasPrev","next","startAfter","prev","endBefore","startAt","missing","missed","getInitialHandler","resolve_1","reject_1","handleInitial","handleUpdate","changes","change","updated","created","getUpdateHandler","handler","getLiveHandler","newIndex","oldIndex"],"mappings":"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","file":"fiery-data.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"FieryData\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"FieryData\"] = factory();\n\telse\n\t\troot[\"FieryData\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { FieryOptions, FierySource, FieryData, FieryMetadata, FieryEntry, FieryFields } from './types'\nimport { getOptionsByKey } from './options'\n\n\n\nexport function isObject (x?: any): x is Object\n{\n  return Object.prototype.toString.call(x) === '[object Object]'\n}\n\nexport function isFunction (x?: any): x is Function\n{\n  return typeof x === 'function'\n}\n\nexport function isString (x?: any): x is string\n{\n  return typeof x === 'string'\n}\n\nexport function isArray (x?: any): x is Array<any>\n{\n  return x && x instanceof Array\n}\n\nexport function isDate (x?: any): x is Date\n{\n  return x && x instanceof Date\n}\n\nexport function isDefined (x?: any): boolean\n{\n  return typeof x !== 'undefined'\n}\n\nexport function isNumber (x?: any): x is number\n{\n  return typeof x === 'number' && isFinite(x)\n}\n\nexport function parseDate (x?: any): Date | any\n{\n  if (isDate(x))\n  {\n    return x\n  }\n\n  if (x && isFunction(x.toDate))\n  {\n    return x.toDate()\n  }\n\n  if (isNumber(x))\n  {\n    return new Date(x)\n  }\n\n  return x\n}\n\nexport function coalesce (a?: any, b?: any): any\n{\n  return isDefined(a) ? a : b\n}\n\nexport function isCollectionSource (source: FierySource): boolean\n{\n  return !!((<any>source).where)\n}\n\nexport function getFields (fields?: FieryFields, otherwise?: string[]): string[] | undefined\n{\n  return !fields ? otherwise : (isString(fields) ? [fields] : fields)\n}\n\n// export function forEach<I, V extends I[keyof I], K extends keyof I>(iterable: I, callback: (item: V, key: K, iterable: I) => any): boolean\n// export function forEach<V, K>(iterable: V[], callback: (item: V, key: K, iterable: V[]) => any): boolean\nexport function forEach(iterable: any, callback: (item: any, key: any, iterable: any) => any): boolean\n{\n  if (isArray(iterable))\n  {\n    for (let i = 0; i < iterable.length; i++)\n    {\n      callback(iterable[i], i, iterable)\n    }\n\n    return true\n  }\n  else if (isObject(iterable))\n  {\n    for (let prop in iterable)\n    {\n      if (iterable.hasOwnProperty(prop))\n      {\n        callback(iterable[prop], prop, iterable)\n      }\n    }\n\n    return true\n  }\n\n  return false\n}\n\nexport function isEqual (a: any, b: any): boolean\n{\n  if (a === b)\n  {\n    return true\n  }\n\n  if (!a || !b)\n  {\n    return false\n  }\n\n  if (typeof a !== typeof b)\n  {\n    return false\n  }\n\n  if (isArray(a) && isArray(b))\n  {\n    if (a.length !== b.length)\n    {\n      return false\n    }\n\n    for (let i = 0; i < a.length; i++)\n    {\n      if (!isEqual(a[i], b[i]))\n      {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  if (isDate(a) && isDate(b))\n  {\n    return a.getTime() === b.getTime()\n  }\n\n  if (isObject(a) && isObject(b))\n  {\n    for (let prop in a)\n    {\n      if (!isEqual(a[prop], b[prop]))\n      {\n        return false\n      }\n    }\n\n    for (let prop in b)\n    {\n      if (!(prop in a))\n      {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  return false\n}\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { UID_SEPARATOR, PROP_UID, PATH_SEPARATOR, ENTRY_SEPARATOR } from './constants'\nimport { FieryInstance, FieryEntry, FierySource, FieryCacheEntry, FieryCache, FieryData, FieryOptions, FieryOptionsMap, FieryEntryMap } from './types'\nimport { closeEntry, getEntry } from './entry'\nimport { factory } from './factory'\nimport { stats } from './stats'\nimport { callbacks } from './callbacks'\n\n\n\nexport let globalCache: FieryCache = Object.create(null)\n\n\nexport function destroyGlobalCache()\n{\n  globalCache = Object.create(null)\n}\n\nexport function getCacheForReference (entry: FieryEntry, ref: firebase.firestore.DocumentReference, checkSubs: boolean = false): FieryCacheEntry\n{\n  const uid = entry.storeKey + UID_SEPARATOR + ref.path\n\n  if (uid in globalCache)\n  {\n    addCacheToEntry(globalCache[uid], entry, checkSubs)\n\n    return globalCache[uid]\n  }\n\n  const data = entry.options.newDocument()\n\n  data[PROP_UID] = uid\n\n  const cache: FieryCacheEntry = {\n    uid,\n    data,\n    ref,\n    exists: false,\n    uses: 0,\n    sub: {},\n    firstEntry: entry,\n    entries: [],\n    removed: false\n  }\n\n  globalCache[uid] = cache\n\n  addCacheToEntry(cache, entry, true)\n  createRecord(data, entry)\n\n  callbacks.onCacheCreate(cache)\n\n  return cache\n}\n\nexport function getCacheForDocument (entry: FieryEntry, doc: firebase.firestore.DocumentSnapshot, checkSubs: boolean = false): FieryCacheEntry\n{\n  stats.reads++\n\n  return getCacheForReference(entry, doc.ref, checkSubs)\n}\n\nexport function getCacheForData (data: FieryData): FieryCacheEntry | undefined\n{\n  return globalCache[data[PROP_UID]]\n}\n\nexport function removeDataFromEntry (entry: FieryEntry, data: FieryData): void\n{\n  removeCacheFromEntry(entry, getCacheForData(data))\n}\n\nexport function removeCacheFromEntry (entry: FieryEntry, cache?: FieryCacheEntry): void\n{\n  if (cache && cache.uid in entry.children)\n  {\n    const options: FieryOptions = entry.options\n    const entries: FieryEntry[] = cache.entries\n\n    // remove reference to entry from cache\n    const entryIndex = entries.indexOf(entry)\n    if (entryIndex !== -1)\n    {\n      entries.splice(entryIndex, 1)\n    }\n\n    // remove cache reference from entry\n    delete entry.children[cache.uid]\n\n    // if no more entries for this instance, remove from instance\n    let inInstance: boolean = false\n\n    for (var i = 0; i < entries.length; i++)\n    {\n      if (entries[i].instance === entry.instance)\n      {\n        inInstance = true\n        break\n      }\n    }\n\n    if (!inInstance)\n    {\n      removeCacheFromInstance(cache, entry.instance, true)\n    }\n\n    // turn off any unneeded subs if we're still being used\n    if (cache.uses > 0)\n    {\n      for (var sub in cache.sub)\n      {\n        if (!isReferencedSub(cache, sub))\n        {\n          callbacks.onSubDestroy(cache.data, sub, cache)\n\n          closeEntry(cache.sub[sub], true)\n        }\n      }\n    }\n  }\n}\n\nexport function isReferencedSub (cache: FieryCacheEntry, sub: string): boolean\n{\n  const entries: FieryEntry[] = cache.entries\n  const subs: FieryEntryMap = cache.sub\n\n  for (var i = 0; i < entries.length; i++)\n  {\n    const entry: FieryEntry = entries[i]\n    const entrySubs: FieryOptionsMap | undefined = entry.options.sub as (FieryOptionsMap | undefined)\n\n    if (entrySubs && sub in entrySubs)\n    {\n      return true\n    }\n  }\n\n  return false\n}\n\nexport function addCacheToEntry (cache: FieryCacheEntry, entry: FieryEntry, checkSubs: boolean = false): void\n{\n  if (!(cache.uid in entry.instance.cache))\n  {\n    entry.instance.cache[cache.uid] = cache\n    cache.uses++\n  }\n\n  if (!(cache.uid in entry.children))\n  {\n    cache.entries.push(entry)\n    entry.children[cache.uid] = cache\n\n    addSubs(cache, entry)\n  }\n  else if (checkSubs)\n  {\n    addSubs(cache, entry)\n  }\n}\n\nexport function removeCacheFromInstance (cache: FieryCacheEntry, instance: FieryInstance, checkForDestroy: boolean = true): void\n{\n  if (cache.uid in instance.cache)\n  {\n    cache.uses--\n    delete instance.cache[cache.uid]\n\n    const entries: FieryEntry[] = cache.entries\n\n    for (let i = entries.length - 1; i >= 0; i--)\n    {\n      const entry = entries[i]\n\n      if (entry.instance === instance)\n      {\n        removeCacheFromEntry(entry, cache)\n      }\n    }\n\n    if (checkForDestroy && cache.uses <= 0)\n    {\n      destroyCache(cache)\n    }\n  }\n}\n\nexport function destroyCache (cache: FieryCacheEntry): void\n{\n  const entries: FieryEntry[] = cache.entries\n\n  for (let i = 0; i < entries.length; i++)\n  {\n    removeCacheFromInstance(cache, entries[i].instance, false)\n  }\n\n  for (var sub in cache.sub)\n  {\n    closeEntry(cache.sub[sub], true)\n  }\n\n  if (cache.uses <= 0 && !cache.removed)\n  {\n    callbacks.onCacheDestroy(cache)\n\n    delete globalCache[cache.uid]\n    delete cache.ref\n    delete cache.sub\n    delete cache.data\n\n    cache.entries.length = 0\n    cache.removed = true\n  }\n}\n\nexport function addSubs (cache: FieryCacheEntry, entry: FieryEntry): void\n{\n  const options: FieryOptions = entry.options\n  const data: FieryData = cache.data\n  const ref: firebase.firestore.DocumentReference | undefined = cache.ref\n\n  if (options.sub && ref)\n  {\n    for (let subProp in options.sub)\n    {\n      if (!hasLiveSub(cache, subProp))\n      {\n        let subOptions: FieryOptions = options.sub[subProp] as FieryOptions\n        let subName: string = cache.uid + ENTRY_SEPARATOR + subProp\n\n        let subSource: FierySource = subOptions.doc\n          ? ref.parent.doc(cache.uid.split(PATH_SEPARATOR).pop() + PATH_SEPARATOR + subProp)\n          : ref.collection(subProp)\n\n        let subEntry: FieryEntry = getEntry(\n          entry.instance,\n          subSource,\n          subOptions,\n          subName,\n          false // we shouldn't add this to sources\n        )\n\n        subEntry.parent = cache\n        cache.sub[subProp] = subEntry\n\n        data[subProp] = factory(subEntry)\n\n        callbacks.onSubCreate(data, subProp, cache)\n      }\n    }\n  }\n}\n\nexport function hasLiveSub (cache: FieryCacheEntry, sub: string): boolean\n{\n  return sub in cache.sub && cache.sub[sub].live\n}\n\nexport function createRecord (data: FieryData, entry: FieryEntry): FieryData\n{\n  const options: FieryOptions = entry.options\n\n  if (options.record)\n  {\n    Object.defineProperties(data, entry.recordProperties)\n  }\n\n  return data\n}\n","\nimport { FieryData, FieryCacheEntry, FieryTarget, FieryEntry, FieryInstance } from './types'\n\nexport const callbacks =\n{\n  onInvalidOperation (data: FieryData, operation: string) {},\n\n  onUpdate (data: FieryData, values: FieryData, cache: FieryCacheEntry) {},\n\n  onSet (data: FieryData, values: FieryData, cache: FieryCacheEntry) {},\n\n  onDelete (data: FieryData, cache: FieryCacheEntry) {},\n\n  onClear (data: FieryData, props: string[]) {},\n\n  onGetChanges (data: FieryData, cache: FieryCacheEntry, fields?: string[]) {},\n\n  onRefresh (data: FieryData, cachedOnly?: boolean) {},\n\n  onBuild (data: FieryData, cache: FieryCacheEntry) {},\n\n  onCacheCreate (cache: FieryCacheEntry) {},\n\n  onCacheDestroy (cache: FieryCacheEntry) {},\n\n  onSubCreate (data: FieryData, sub: string, cache: FieryCacheEntry) {},\n\n  onSubDestroy (data: FieryData, sub: string, cache: FieryCacheEntry) {},\n\n  onCollectionAdd (data: FieryData, target: FieryTarget, entry: FieryEntry) {},\n\n  onCollectionRemove (data: FieryData, target: FieryTarget, entry: FieryEntry) {},\n\n  onCollectionModify (data: FieryData, target: FieryTarget, entry: FieryEntry) {},\n\n  onCollectionChanged (target: FieryTarget, entry: FieryEntry) {},\n\n  onDocumentUpdate (data: FieryData, entry: FieryEntry) {},\n\n  onDocumentMissing (data: FieryData, entry: FieryEntry) {},\n\n  onInstanceCreate (instance: FieryInstance) {},\n\n  onInstanceDestroy (instance: FieryInstance) {},\n}\n","\n\nexport const stats = {\n  queries: 0,\n  reads: 0,\n  deletes: 0,\n  updates: 0,\n  sets: 0,\n  writes: 0\n}\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { FierySource, FierySystem, FieryOptions, FieryInstance, FieryEntry, FieryData, FieryMap, FieryFields, FieryCacheEntry } from './types'\nimport { isObject, getFields } from './util'\n\n\n\nexport function refreshData (cache: FieryCacheEntry, doc: firebase.firestore.DocumentSnapshot, entry: FieryEntry): FieryData\n{\n  const system: FierySystem = entry.instance.system\n  const options: FieryOptions = entry.options\n  const encoded: FieryData = parseDocument(doc, options)\n  const decoded: FieryData = decodeData(encoded, options)\n  const data: FieryData = cache.data\n\n  copyData(system, data, decoded)\n\n  if (options.propExists)\n  {\n    system.setProperty(data, options.propExists, doc.exists)\n  }\n\n  if (options.propParent && entry.parent)\n  {\n    system.setProperty(data, options.propParent, entry.parent.data)\n  }\n\n  cache.exists = doc.exists\n\n  return data;\n}\n\nexport function copyData (system: FierySystem, data: FieryData, update: FieryData): FieryData\n{\n  for (let prop in update)\n  {\n    system.setProperty(data, prop, update[prop])\n  }\n\n  return data\n}\n\nexport function decodeData (encoded: FieryData, options: FieryOptions): FieryData\n{\n  if (options.decode)\n  {\n    encoded = options.decode(encoded)\n  }\n  else if (options.decoders)\n  {\n    for (let prop in options.decoders)\n    {\n      if (prop in encoded)\n      {\n        encoded[prop] = options.decoders[prop](encoded[prop], encoded)\n      }\n    }\n  }\n\n  return encoded\n}\n\nexport function encodeData (data: FieryData, options: FieryOptions, fields?: FieryFields): FieryData\n{\n  const values: FieryData = {}\n  const explicit: string[] = getFields(fields, options.include) as string[]\n\n  if (explicit)\n  {\n    for (let i = 0; i < explicit.length; i++)\n    {\n      let prop: string = explicit[i]\n\n      if (prop in data)\n      {\n        values[prop] = data[prop]\n      }\n    }\n  }\n  else\n  {\n    for (let prop in data)\n    {\n      if (!(prop in options.exclude))\n      {\n        values[prop] = data[prop]\n      }\n    }\n  }\n\n  if (options.encoders)\n  {\n    for (let prop in options.encoders)\n    {\n      if (prop in values)\n      {\n        values[prop] = options.encoders[prop](values[prop], data)\n      }\n    }\n  }\n\n  return values\n}\n\nexport function parseDocument (doc: firebase.firestore.DocumentSnapshot, options: FieryOptions): FieryData\n{\n  let value = doc.data()\n  let out = (isObject(value) ? value : { [options.propValue]: value }) as FieryData\n\n  if (out && options.key)\n  {\n    out[options.key] = doc.id\n  }\n\n  return out\n}\n","\nexport const PROP_VALUE = '.value'\nexport const PROP_UID = '.uid'\nexport const UID_SEPARATOR = '///'\nexport const ENTRY_SEPARATOR = '/'\nexport const PATH_SEPARATOR = '/'\nexport const RECORD_OPTIONS = {\n  refresh: '$refresh',\n  sync: '$sync',\n  update: '$update',\n  save: '$save',\n  remove: '$remove',\n  ref: '$ref',\n  clear: '$clear',\n  build: '$build',\n  create: '$create',\n  getChanges: '$getChanges'\n}\n","\n\nimport { FierySystem, FieryOptionsInput, FieryEntryMap, FieryOptions, FieryInstance, FieryEntry, FierySources, FierySource, FieryCache, FieryData, FieryChanges, FieryEquality, FieryFields, FieryRecordProperties } from './types'\nimport { isCollectionSource, forEach, isDefined, isArray, isFunction } from './util'\nimport { getOptions, recycleOptions } from './options'\nimport { getStoreKey } from './store'\nimport { removeCacheFromEntry } from './cache'\nimport * as operations from './operations'\n\n\n\nexport function closeEntry (entry: FieryEntry | null, remove: boolean = false): void\n{\n  if (entry && entry.live)\n  {\n    if (entry.off)\n    {\n      entry.off()\n\n      delete entry.off\n    }\n\n    entry.live = false\n\n    if (remove)\n    {\n      const instance: FieryInstance = entry.instance\n\n      if (isDefined(entry.index))\n      {\n        instance.entryList[entry.index as number] = null\n\n        delete entry.index\n      }\n\n      if (entry.name && entry.name in instance.entry)\n      {\n        delete instance.entry[entry.name]\n      }\n\n      forEach(entry.children, cached =>\n      {\n        removeCacheFromEntry(entry, cached)\n      })\n    }\n  }\n}\n\nexport function getEntry (instance: FieryInstance, source: FierySource, optionsInput?: FieryOptionsInput, name?: string, namedSource: boolean = true)\n{\n  // Things that are allowed to change on repetitive entry calls\n  const options: FieryOptions = getOptions(optionsInput, instance)\n  const storeKey: number = getStoreKey(source)\n\n  if (name && name in instance.entry)\n  {\n    const existing: FieryEntry = instance.entry[ name ]\n\n    closeEntry(existing)\n\n    if (options.id !== existing.options.id)\n    {\n      recycleOptions(existing.options)\n    }\n\n    existing.source = source\n    existing.options = options\n    existing.storeKey = storeKey\n    existing.live = true\n\n    if (name && namedSource)\n    {\n      instance.sources[ name ] = source\n    }\n\n    return existing\n  }\n\n  const recordFunctions = getEntryRecordFunctions(instance)\n  const recordProperties = getEntryRecordProperties(options, recordFunctions)\n  const children: FieryCache = {}\n  const live: boolean = true\n  const entry: FieryEntry = {\n    name,\n    options,\n    source,\n    instance,\n    storeKey,\n    children,\n    recordFunctions,\n    recordProperties,\n    live\n  }\n\n  if (!name || !(name in instance.entry))\n  {\n    entry.index = instance.entryList.length\n\n    instance.entryList.push(entry)\n  }\n\n  if (name)\n  {\n    instance.entry[ name ] = entry\n  }\n\n  if (name && namedSource)\n  {\n    instance.sources[ name ] = source\n  }\n\n  return entry\n}\n\nexport function updatePointers (entry: FieryEntry, querySnapshot: firebase.firestore.QuerySnapshot): void\n{\n  const docs = querySnapshot.docs\n  \n  entry.first = docs[0]\n  entry.last = docs[docs.length - 1]\n}\n\nexport function getChanges (querySnapshot: firebase.firestore.QuerySnapshot): firebase.firestore.DocumentChange[]\n{\n  if (isFunction(querySnapshot.docChanges))\n  {\n    return querySnapshot.docChanges()\n  }\n\n  if (isArray(querySnapshot.docChanges))\n  {\n    return (<any>querySnapshot.docChanges) as firebase.firestore.DocumentChange[]\n  }\n\n  return []\n}\n\nexport function getEntryRecordFunctions (instance: FieryInstance)\n{\n  return {\n    refresh: function(this: FieryData, cachedOnly?: boolean): Promise<void> {\n      return operations.refresh.call(instance, this, cachedOnly)\n    },\n    sync: function(this: FieryData, fields?: FieryFields): Promise<void> {\n      return operations.sync.call(instance, this, fields)\n    },\n    update: function(this: FieryData, fields?: FieryFields): Promise<void> {\n      return operations.update.call(instance, this, fields)\n    },\n    save: function(this: FieryData, fields?: FieryFields): Promise<void> {\n      return operations.save.call(instance, this, fields)\n    },\n    remove: function(this: FieryData, excludeSubs: boolean = false): Promise<void> {\n      return operations.remove.call(instance, this, excludeSubs)\n    },\n    ref: function(this: FieryData, sub?: string): FierySource {\n      return operations.ref.call(instance, this, sub)\n    },\n    clear: function(this: FieryData, props: FieryFields): Promise<void[]> {\n      return operations.clear.call(instance, this, props)\n    },\n    build: function<T extends FieryData>(this: FieryData, sub: string, initial?: FieryData): T {\n      return operations.buildSub.call(instance, this, sub, initial)\n    },\n    create: function<T extends FieryData>(this: FieryData, sub: string, initial?: FieryData): T {\n      return operations.createSub.call(instance, this, sub, initial)\n    },\n    getChanges: function(this: FieryData,\n      fieldsOrEquality: FieryFields | FieryEquality,\n      equalityOrNothing?: FieryEquality): Promise<FieryChanges> {\n      return operations.getChanges.call(instance, this, fieldsOrEquality, equalityOrNothing)\n    }\n  }\n}\n\nexport function getEntryRecordProperties (options: FieryOptions, recordFunctions: any): FieryRecordProperties\n{\n  const props: FieryRecordProperties = {}\n\n  for (var prop in options.recordOptions)\n  {\n    const newProp = options.recordOptions[prop]\n\n    props[newProp] = {\n      value: recordFunctions[prop]\n    }\n  }\n\n  return props\n}\n","\nimport { PROP_UID, PROP_VALUE, RECORD_OPTIONS } from './constants'\nimport { FieryOptionsInput, FieryTarget, FieryOptions, FieryOptionsMap, FieryInstance, FieryExclusions, FierySource, FieryData, FieryMap, FieryEquality, FieryMergeStrategy, FieryMergeStrategies } from './types'\nimport { parseDate, isObject, isFunction, isArray, coalesce, forEach, isDefined, isString } from './util'\nimport * as operations from './operations'\n\n\n\nexport const globalOptions =\n{\n  defined: {} as FieryOptionsMap,\n\n  user: undefined as Partial<FieryOptions> | undefined,\n\n  defaults:\n  {\n    onError: (message: any) => {},\n\n    onMissing: () => {},\n\n    onSuccess: (results: any) => {},\n\n    onRemove: () => {},\n\n    onMutate: (mutate: () => FieryTarget) => {\n      mutate()\n    },\n\n    liveOptions: {},\n\n    propValue: PROP_VALUE,\n\n    recordOptions: RECORD_OPTIONS,\n\n    newDocument: (encoded?: FieryData) => ({} as FieryData)\n\n  } as Partial<FieryOptions>,\n\n  id: 0,\n\n  map: {} as FieryOptionsMap\n}\n\n\nexport function getOptionsByKey (key: string): FieryOptions\n{\n  return globalOptions.map[parseInt(key)] as FieryOptions\n}\n\nexport function getOptions (options?: FieryOptionsInput, instance?: FieryInstance): FieryOptions\n{\n  // If a string is passed - returned a defined option.\n  if (isString(options))\n  {\n    if (!(options in globalOptions.defined))\n    {\n      throw 'The definition ' + options + ' was not found. You must call define before you use the definition'\n    }\n\n    // Ensure the defined option is properly populated\n    return getOptions(globalOptions.defined[options])\n  }\n\n  // If nothing was given, populate an empty set of options\n  if (!options || !isObject(options))\n  {\n    options = {}\n  }\n\n  // If the options was already populated, return the options\n  if (options.id && options.id in globalOptions.map)\n  {\n    return options as FieryOptions\n  }\n  // Otherwise, assign this options an id and add it to the list of options\n  else if (!options.id)\n  {\n    options.id = ++globalOptions.id\n    globalOptions.map[options.id] = options as FieryOptions\n  }\n\n  if (options.extends)\n  {\n    performMerge(options, getOptions(options.extends))\n  }\n\n  performMerge(options, globalOptions.user)\n  performMerge(options, globalOptions.defaults)\n\n  if (instance && !options.shared)\n  {\n    options.instance = instance\n    instance.options[ options.id ] = options as FieryOptions\n  }\n\n  if (options.type)\n  {\n    const typeConstructor = options.type\n\n    options.newDocument = (encoded?: FieryData) => (new typeConstructor() as FieryData)\n  }\n\n  if (!options.newCollection)\n  {\n    options.newCollection = options.map\n      ? () => ({} as FieryMap)\n      : () => ([] as FieryData[])\n  }\n\n  let excludeMap: FieryExclusions = {}\n\n  if (!options.exclude)\n  {\n    if (options.key)\n    {\n      excludeMap[options.key] = true\n    }\n  }\n  else if (isArray(options.exclude))\n  {\n    forEach(options.exclude, (value, key) => excludeMap[value] = true)\n  }\n  else\n  {\n    excludeMap = options.exclude as FieryExclusions\n  }\n\n  excludeMap[options.propValue as string] = true\n  excludeMap[PROP_UID] = true\n\n  forEach(options.recordOptions, (value, key) => excludeMap[value] = true)\n\n  options.exclude = excludeMap\n\n  if (options.sub)\n  {\n    for (let subProp in options.sub)\n    {\n      let subOptionsInput = options.sub[subProp] as FieryOptionsInput\n      let subOptions = getOptions(subOptionsInput, instance)\n\n      subOptions.parent = options as FieryOptions\n\n      options.sub[subProp] = subOptions\n\n      if (!subOptions.ref)\n      {\n        excludeMap[subProp] = true\n      }\n    }\n  }\n\n  if (isArray(options.timestamps) && options.timestamps.length)\n  {\n    let decoders = options.decoders || {}\n\n    forEach(options.timestamps, timestamp =>\n    {\n      if (!(timestamp in decoders))\n      {\n        decoders[timestamp] = parseDate\n      }\n    })\n\n    options.decoders = decoders\n  }\n\n  return options as FieryOptions\n}\n\nexport function recycleOptions (options: FieryOptions)\n{\n  const instance: FieryInstance | undefined = options.instance\n\n  if (instance)\n  {\n    delete instance.options[options.id]\n  }\n}\n\nexport function define (nameOrMap: string | FieryOptionsMap, namedOptions?: Partial<FieryOptions>): void\n{\n  if (isString(nameOrMap))\n  {\n    const options: Partial<FieryOptions> = namedOptions as Partial<FieryOptions>\n\n    options.shared = true\n\n    globalOptions.defined[nameOrMap] = options\n  }\n  else\n  {\n    for (let name in nameOrMap)\n    {\n      const options: Partial<FieryOptions> = nameOrMap[name]\n\n      options.shared = true\n\n      globalOptions.defined[name] = options\n    }\n  }\n}\n\nexport function setGlobalOptions (user?: Partial<FieryOptions>): void\n{\n  if (user)\n  {\n    user.shared = true\n  }\n\n  globalOptions.user = user\n}\n\nexport function performMerge (options: Partial<FieryOptions>, defaults?: Partial<FieryOptions>): void\n{\n  if (!defaults) return\n\n  for (let prop in mergeOptions)\n  {\n    const optionsProp = prop as keyof FieryOptions\n    const merger: FieryMergeStrategy = mergeOptions[optionsProp]\n\n    options[optionsProp] = merger( options[optionsProp], defaults[optionsProp] )\n  }\n}\n\nexport const mergeStrategy: FieryMergeStrategies =\n{\n  ignore (options: any, defaults: any): any {\n    return options\n  },\n  replace (options: any, defaults: any): any {\n    return coalesce(options, defaults)\n  },\n  chain (options: any, defaults: any): any {\n    if (!isDefined(defaults)) return options\n    if (!isDefined(options)) return defaults\n\n    return function(this: any) {\n      (defaults as Function).apply(this, arguments)\n      (options as Function).apply(this, arguments)\n    }\n  },\n  shallow (options: any, defaults: any): any {\n    if (!isDefined(defaults)) return options\n    if (!isDefined(options)) return defaults\n\n    return {\n      ...defaults,\n      ...options\n    }\n  },\n  concat (options: any, defaults: any): any {\n    if (!isDefined(defaults)) return options\n    if (!isDefined(options)) return defaults\n\n    if (isArray(options) && isArray(defaults)) {\n      let union = options.concat(defaults)\n      let added: {[k:string]:any} = {}\n      for (let i = union.length - 1; i >= 0; i--) {\n        if (union[i] in added) {\n          union.splice(i, 1)\n        } else {\n          added[union[i]] = true\n        }\n      }\n      return union\n    }\n  },\n  exclude (options: any, defaults: any): any {\n    const union = mergeStrategy.concat(options, defaults)\n    if (!union && options && defaults) {\n      let exclusions: {[k:string]:any} = {}\n      let defaultsArray = isArray(defaults)\n      let optionsArray = isArray(options)\n      forEach(defaults, (value, key) => value ? (exclusions[defaultsArray ? value : key] = true) : 0)\n      forEach(options, (value, key) => value ? (exclusions[optionsArray ? value : key] = true) : 0)\n      return exclusions\n    }\n    return union\n  }\n}\n\nexport const mergeOptions: FieryMergeStrategies =\n{\n  extends:            mergeStrategy.ignore,\n  id:                 mergeStrategy.ignore,\n  parent:             mergeStrategy.ignore,\n  shared:             mergeStrategy.ignore,\n  vm:                 mergeStrategy.ignore,\n  key:                mergeStrategy.replace,\n  query:              mergeStrategy.replace,\n  map:                mergeStrategy.replace,\n  once:               mergeStrategy.replace,\n  type:               mergeStrategy.replace,\n  nullifyMissing:     mergeStrategy.replace,\n  newDocument:        mergeStrategy.replace,\n  newCollection:      mergeStrategy.replace,\n  decode:             mergeStrategy.replace,\n  decoders:           mergeStrategy.shallow,\n  encoders:           mergeStrategy.shallow,\n  record:             mergeStrategy.replace,\n  recordOptions:      mergeStrategy.replace,\n  recordFunctions:    mergeStrategy.replace,\n  propValue:          mergeStrategy.replace,\n  propExists:         mergeStrategy.replace,\n  propParent:         mergeStrategy.replace,\n  onceOptions:        mergeStrategy.replace,\n  liveOptions:        mergeStrategy.replace,\n  include:            mergeStrategy.concat,\n  exclude:            mergeStrategy.exclude,\n  timestamps:         mergeStrategy.concat,\n  onError:            mergeStrategy.replace,\n  onSuccess:          mergeStrategy.replace,\n  onMissing:          mergeStrategy.replace,\n  onRemove:           mergeStrategy.replace,\n  onMutate:           mergeStrategy.replace,\n  sub:                mergeStrategy.shallow\n}\n","\n\nimport { FieryInstance, FieryEntry, FieryTarget, FierySource, FieryOptions } from '../types'\nimport { getEntry } from '../entry'\n\n\n\nimport factoryDocument from './document'\nimport factoryMap from './map'\nimport factoryCollection from './collection'\n\n\n\nexport function factory (entry: FieryEntry): FieryTarget\n{\n  let chosenFactory = (<any>entry.source).where\n    ? (entry.options.map ? factoryMap : factoryCollection)\n    : factoryDocument\n\n  return chosenFactory(entry)\n}\n\nexport default factory\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { FieryInstance, FierySystem, FieryCacheEntry, FieryOptions, FieryEntry, FieryData, FierySource, FieryChanges, FieryEquality, FieryFields, FieryTarget, FieryPager } from './types'\nimport { parseDocument, encodeData, refreshData } from './data'\nimport { forEach, isEqual, isDefined, isFunction, isString, getFields } from './util'\nimport { getCacheForData, getCacheForReference } from './cache'\nimport { stats } from './stats'\nimport { callbacks } from './callbacks'\nimport { getPager } from './pager'\n\n\n\nexport function pager (this: FieryInstance, target: FieryTarget): FieryPager | null\n{\n  const entry = this.entryFor(target)\n\n  return entry\n    ? (entry.pager ? entry.pager : entry.pager = getPager(entry))\n    : null\n}\n\nexport function refresh (this: FieryInstance, data: FieryData, cachedOnly: boolean = false): Promise<void>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const entry: FieryEntry = cache.firstEntry\n    const options: FieryOptions = entry.options\n    const system: FierySystem = entry.instance.system\n    const getOptions: firebase.firestore.GetOptions = {\n      source: cachedOnly ? 'cache' : 'default'\n    }\n\n    stats.reads++\n\n    callbacks.onRefresh(data, cachedOnly)\n\n    return cache.ref.get(getOptions).then(doc =>\n    {\n      options.onMutate(() =>\n      {\n        if (doc.exists)\n        {\n          refreshData(cache, doc, entry)\n        }\n        else\n        {\n          if (options.propExists)\n          {\n            system.setProperty(cache.data, options.propExists, false)\n          }\n\n          cache.exists = false\n        }\n\n        return cache.data\n      })\n    })\n  }\n\n  callbacks.onInvalidOperation(data, 'refresh')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function save (this: FieryInstance, data: FieryData, fields?: FieryFields): Promise<void>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const options: FieryOptions = cache.firstEntry.options\n    const values: FieryData = encodeData(data, options, fields)\n\n    if (cache.exists)\n    {\n      stats.writes++\n      stats.updates++\n\n      callbacks.onUpdate(data, values, cache)\n\n      return cache.ref.update(values)\n    }\n    else\n    {\n      return cache.ref.get().then(doc =>\n      {\n        stats.writes++\n\n        if (doc.exists)\n        {\n          stats.updates++\n\n          callbacks.onUpdate(data, values, cache)\n\n          return cache.ref.update(values)\n        }\n        else\n        {\n          const createValues = encodeData(data, options)\n\n          stats.sets++\n\n          callbacks.onSet(data, createValues, cache)\n\n          return cache.ref.set(createValues)\n        }\n      })\n    }\n  }\n\n  callbacks.onInvalidOperation(data, 'save')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function update (this: FieryInstance, data: FieryData, fields?: FieryFields): Promise<void>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const options: FieryOptions = cache.firstEntry.options\n    const values: FieryData = encodeData(data, options, fields)\n\n    stats.writes++\n    stats.updates++\n\n    callbacks.onUpdate(data, values, cache)\n\n    return cache.ref.update(values)\n  }\n\n  callbacks.onInvalidOperation(data, 'update')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function sync (this: FieryInstance, data: FieryData, fields?: FieryFields): Promise<void>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const options: FieryOptions = cache.firstEntry.options\n    const values: FieryData = encodeData(data, options, fields)\n\n    stats.sets++\n    stats.writes++\n\n    callbacks.onSet(data, values, cache)\n\n    return cache.ref.set(values)\n  }\n\n  callbacks.onInvalidOperation(data, 'sync')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function remove(this: FieryInstance, data: FieryData, excludeSubs: boolean = false): Promise<void>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const options: FieryOptions = cache.firstEntry.options\n\n    if (!excludeSubs && options.sub)\n    {\n      for (let subProp in options.sub)\n      {\n        forEach(data[subProp], (sub) =>\n        {\n          remove.call(this, sub as FieryData)\n        })\n      }\n    }\n\n    stats.deletes++\n\n    callbacks.onDelete(data, cache)\n\n    return cache.ref.delete()\n  }\n\n  callbacks.onInvalidOperation(data, 'remove')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function clear (this: FieryInstance, data: FieryData, props: FieryFields): Promise<void[]>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n  const propsArray: string[] = getFields(props) as string[]\n\n  if (cache && cache.ref)\n  {\n    const options: FieryOptions = cache.firstEntry.options\n    const ref: firebase.firestore.DocumentReference = cache.ref\n    const store: firebase.firestore.Firestore = ref.firestore\n    const promises: Promise<void>[] = []\n\n    const deleting: any = {}\n    let deleteCount: number = 0\n\n    for (let prop of propsArray)\n    {\n      if (options.sub && prop in options.sub && data[prop])\n      {\n        forEach(data[prop], (sub) =>\n        {\n          promises.push(remove.call(this, sub as FieryData))\n        })\n      }\n      else if (prop in data)\n      {\n        let firebaseRuntime: any = (<any>store.app).firebase_\n\n        if (firebaseRuntime)\n        {\n          deleting[prop] = firebaseRuntime.firestore.FieldValue.delete()\n          deleteCount++\n        }\n      }\n    }\n\n    if (deleteCount > 0)\n    {\n      stats.updates++\n      stats.writes++\n\n      promises.push(ref.update(deleting))\n    }\n\n    callbacks.onClear(data, propsArray)\n\n    return Promise.all(promises)\n  }\n\n  callbacks.onInvalidOperation(data, 'clear')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function getChanges (this: FieryInstance,\n  data: FieryData,\n  fieldsOrEquality: FieryFields | FieryEquality,\n  equalityOrNothing?: FieryEquality): Promise<FieryChanges>\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const fields: FieryFields | undefined = isFunction(fieldsOrEquality) ? undefined : getFields(fieldsOrEquality as FieryFields)\n    const equality: FieryEquality = ((fields ? equalityOrNothing : fieldsOrEquality) || isEqual) as FieryEquality\n    const options: FieryOptions = cache.firstEntry.options\n    const current: FieryData = encodeData(data, options, fields)\n\n    stats.reads++\n\n    callbacks.onGetChanges(data, cache, fields)\n\n    return cache.ref.get().then(doc =>\n    {\n      const encoded: FieryData = parseDocument(doc, options)\n      const remote: FieryData = {}\n      const local: FieryData = {}\n      let changed = false\n\n      for (let prop in current)\n      {\n        let remoteValue = encoded[prop]\n        let localValue = current[prop]\n\n        if (!equality(remoteValue, localValue))\n        {\n          changed = true\n          remote[prop] = remoteValue\n          local[prop] = localValue\n        }\n      }\n\n      return Promise.resolve({ changed, remote, local })\n    })\n  }\n\n  callbacks.onInvalidOperation(data, 'getChanges')\n\n  return Promise.reject('The given data is out of scope and cannot be operated on.')\n}\n\nexport function ref (this: FieryInstance, data: FieryData, sub?: string): FierySource\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref)\n  {\n    const ref: firebase.firestore.DocumentReference = cache.ref\n\n    return sub ? ref.collection(sub) : ref\n  }\n\n  throw 'The given data is out of scope and cannot be referenced.'\n}\n\nexport function create <T extends FieryData>(this: FieryInstance, target: string | FieryTarget, initial?: FieryData): T\n{\n  const built: T = this.build(target, initial)\n\n  if (built)\n  {\n    this.sync(built)\n  }\n\n  return built\n}\n\nexport function createSub <T extends FieryData>(this: FieryInstance, data: FieryData, sub: string, initial?: FieryData): T\n{\n  const built: T = this.buildSub(data, sub, initial)\n\n  if (built)\n  {\n    this.sync(built)\n  }\n\n  return built\n}\n\nexport function build <T extends FieryData>(this: FieryInstance, target: string | FieryTarget, initial?: FieryData): T\n{\n  const entry = this.entryFor(target)\n\n  if (entry)\n  {\n    return buildFromCollection (entry.source as firebase.firestore.CollectionReference, entry, initial)\n  }\n\n  throw 'Cannot build ' + target + + ', it does not exist in the current $fiery instance.'\n}\n\nexport function buildSub <T extends FieryData>(this: FieryInstance, data: FieryData, sub: string, initial?: FieryData): T\n{\n  const cache: FieryCacheEntry | undefined = getCacheForData(data)\n\n  if (cache && cache.ref && sub in cache.sub)\n  {\n    const entry: FieryEntry = cache.sub[sub]\n    const ref: firebase.firestore.DocumentReference = cache.ref\n\n    return buildFromCollection(ref.collection(sub), entry, initial)\n  }\n\n  throw 'Cannot build in the sub collection ' + sub + + ', the parent data does not exist in the current $fiery instance or the sub collection is not defined in the options.'\n}\n\nexport function buildFromCollection <T extends FieryData>(collection: firebase.firestore.CollectionReference, entry: FieryEntry, initial?: FieryData): T\n{\n  const options: FieryOptions = entry.options\n  const ref = collection.doc()\n  const cache: FieryCacheEntry = getCacheForReference(entry, ref)\n\n  if (options.defaults)\n  {\n    forEach(options.defaults, (defaultValue, prop) =>\n    {\n      if (!initial || !(prop in initial))\n      {\n        cache.data[prop] = isFunction(defaultValue) ? defaultValue() : defaultValue\n      }\n    })\n  }\n\n  if (initial)\n  {\n    forEach(initial, (value, prop) =>\n    {\n      cache.data[prop] = value\n    })\n  }\n\n  callbacks.onBuild(cache.data, cache)\n\n  return cache.data as T\n}\n","\nimport { getInstance } from './instance'\n\nexport * from './constants'\nexport * from './types'\nexport { stats } from './stats'\nexport { callbacks } from './callbacks'\nexport { define, setGlobalOptions, mergeStrategy, mergeOptions, getOptions } from './options'\nexport { getCacheForData, destroyCache, destroyGlobalCache } from './cache'\n\nexport { getInstance }\nexport default getInstance\n","\nimport { FierySystem, FieryInstance, FieryOptionsInput, FieryTarget, FierySource, FieryEntry, FieryOptions } from './types'\nimport { forEach, isString } from './util'\nimport { factory } from './factory'\nimport { getEntry, closeEntry } from './entry'\nimport { removeCacheFromInstance } from './cache'\nimport { globalOptions } from './options'\nimport { callbacks } from './callbacks'\nimport * as operations from './operations'\n\n\nexport function getInstance (systemOverrides?: Partial<FierySystem>): FieryInstance\n{\n  const system = buildSystem(systemOverrides)\n\n  const targetFactory = (source: FierySource, options?: FieryOptionsInput, name?: string): FieryTarget => {\n    return factory(getEntry(instance, source, options, name))\n  }\n\n  const instance: FieryInstance = targetFactory as FieryInstance\n\n  instance.system = system\n  instance.entry = {}\n  instance.entryList = []\n  instance.options = {}\n  instance.sources = {}\n  instance.cache = {}\n  instance.pager = operations.pager\n  instance.refresh = operations.refresh\n  instance.update = operations.update\n  instance.save = operations.save\n  instance.sync = operations.sync\n  instance.remove = operations.remove\n  instance.clear = operations.clear\n  instance.getChanges = operations.getChanges\n  instance.ref = operations.ref\n  instance.create = operations.create\n  instance.createSub = operations.createSub\n  instance.build = operations.build\n  instance.buildSub = operations.buildSub\n  instance.entryFor = entryFor\n  instance.destroy = destroy\n  instance.free = free\n  instance.linkSources = linkSources\n\n  callbacks.onInstanceCreate(instance as FieryInstance)\n\n  return instance as FieryInstance\n}\n\nfunction destroy(this: FieryInstance)\n{\n  forEach(this.options, opt => delete globalOptions.map[opt.id])\n  forEach(this.cache, cached => removeCacheFromInstance(cached, this))\n  forEach(this.entryList, entry => closeEntry(entry, true))\n\n  this.entry = {}\n  this.entryList = []\n  this.options = {}\n  this.sources = {}\n  this.cache = {}\n\n  callbacks.onInstanceDestroy(this)\n}\n\nfunction free (this: FieryInstance, target: FieryTarget)\n{\n  const entry = this.entryFor(target)\n\n  if (entry !== null)\n  {\n    closeEntry(entry, true)\n  }\n}\n\nfunction entryFor (this: FieryInstance, target: string | FieryTarget): FieryEntry | null\n{\n  if (isString(target))\n  {\n    return this.entry[ target ]\n  }\n\n  const entries = this.entryList\n\n  for (let i = 0; i < entries.length; i++)\n  {\n    const entry = entries[i]\n\n    if (entry && entry.target === target)\n    {\n      return entry\n    }\n  }\n\n  return null\n}\n\nfunction linkSources (this: FieryInstance, container: any): void\n{\n  const entryList: (FieryEntry | null)[] = this.entryList\n\n  for (let i = 0; i < entryList.length; i++)\n  {\n    const entry: FieryEntry | null = entryList[i]\n\n    if (entry === null)\n    {\n      continue\n    }\n\n    const options: FieryOptions = entry.options\n\n    if (!options.parent && !entry.name)\n    {\n      for (let prop in container)\n      {\n        if (container[prop] === entry.target)\n        {\n          entry.name = prop\n\n          this.entry[ prop ] = entry\n          this.sources[ prop ] = entry.source\n\n          break\n        }\n      }\n    }\n  }\n}\n\nfunction buildSystem(systemOverrides?: Partial<FierySystem>): FierySystem\n{\n  const system = systemOverrides || {}\n\n  for (let prop in defaultSystem)\n  {\n    const systemProp = prop as keyof FierySystem\n\n    if (!(systemProp in system))\n    {\n      system[systemProp] = defaultSystem[systemProp]\n    }\n  }\n\n  return system as FierySystem\n}\n\nconst defaultSystem: FierySystem = {\n  removeNamed: (name: string) => {\n\n  },\n  setProperty: (target: any, property: string, value: any) => {\n    target[property] = value\n  },\n  removeProperty: (target: any, property: string) => {\n    delete target[property]\n  },\n  arraySet: (target: any[], index: number, value: any) => {\n    target[index] = value\n  },\n  arrayAdd: (target: any[], value: any) => {\n    target.push(value)\n  },\n  arrayResize: (target: any[], size: number) => {\n    target.length = size\n  }\n}\n","\nimport * as firebase from 'firebase'\n\n\nimport { FierySystem, FieryOptions, FieryEntry, FieryData, FieryCacheEntry, FieryTarget } from '../types'\nimport { refreshData } from '../data'\nimport { getCacheForReference, removeDataFromEntry, destroyCache } from '../cache'\nimport { stats } from '../stats'\nimport { callbacks } from '../callbacks'\n\n\n\ntype OnSnapshot = (querySnapshot: firebase.firestore.DocumentSnapshot) => any\ntype OnResolve = (target: FieryTarget) => any\ntype OnReject = (reason: any) => any\n\n\n\nexport function factory (entry: FieryEntry): FieryData\n{\n  const source: firebase.firestore.DocumentReference = entry.source as firebase.firestore.DocumentReference\n  const options: FieryOptions = entry.options\n  const cache: FieryCacheEntry = getCacheForReference(entry, source, true)\n  const initialTarget: FieryTarget | undefined = entry.target\n\n  let missingSynchronously = false\n  let resolve: OnResolve = () => {}\n  let reject: OnReject = () => {}\n\n  const onSnapshot = (doc: firebase.firestore.DocumentSnapshot) =>\n  {\n    options.onMutate(() =>\n    {\n        handleDocumentUpdate(cache, entry, doc)\n\n        return cache.data\n    })\n\n    missingSynchronously = !doc.exists\n\n    resolve(cache.data)\n\n    return cache.data\n  }\n\n  if (initialTarget && initialTarget !== cache.data)\n  {\n    removeDataFromEntry(entry, initialTarget)\n  }\n\n  entry.target = cache.data\n\n  stats.queries++\n\n  if (options.once)\n  {\n    entry.promise = source.get(options.onceOptions)\n      .then(onSnapshot)\n      .catch(options.onError)\n  }\n  else\n  {\n    entry.promise = new Promise<FieryTarget>((_resolve, _reject) => {\n      resolve = _resolve\n      reject = _reject\n    })\n\n    entry.off = source.onSnapshot(\n      options.liveOptions,\n      onSnapshot,\n      (reason) => {\n        reject(reason)\n        options.onError(reason)\n      }\n    )\n  }\n\n  if (missingSynchronously && options.nullifyMissing)\n  {\n    return (<any>null) as FieryData\n  }\n\n  return entry.target as FieryData\n}\n\nexport function handleDocumentUpdate (cache: FieryCacheEntry, entry: FieryEntry, doc: firebase.firestore.DocumentSnapshot): void\n{\n  const options: FieryOptions = entry.options\n  const system: FierySystem = entry.instance.system\n\n  if (!doc.exists)\n  {\n    callbacks.onDocumentMissing(cache.data, entry)\n\n    if (options.propExists)\n    {\n      system.setProperty(cache.data, options.propExists, false)\n    }\n\n    cache.exists = false\n\n    if (options.nullifyMissing)\n    {\n      destroyCache(cache)\n\n      if (entry.name)\n      {\n        system.removeNamed(entry.name)\n      }\n    }\n  }\n  else\n  {\n    refreshData(cache, doc, entry)\n\n    options.onSuccess(cache.data)\n\n    callbacks.onDocumentUpdate(cache.data, entry)\n  }\n}\n\nexport default factory\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { FierySource } from './types'\n\n\n\nexport const stores = {\n\n  keyNext: 0,\n\n  map: { } as { [storeKey: number]: firebase.firestore.Firestore },\n\n  idToKey: { } as { [id: string]: number }\n\n}\n\nexport function getStoreKey (source: FierySource): number\n{\n  const firestore: firebase.firestore.Firestore = source.firestore\n  const id: string = firestore.app.name\n  let key: number = stores.idToKey[id]\n\n  if (!key)\n  {\n    key = ++stores.keyNext\n    stores.map[key] = firestore\n    stores.idToKey[id] = key\n  }\n\n  return key\n}\n","\nimport { FieryEntry, FieryPager, FieryTarget } from './types'\nimport { isArray, isObject } from './util'\n\n\n\nexport function getPager(entry: FieryEntry): FieryPager\n{\n  let pointer: firebase.firestore.DocumentSnapshot | undefined\n\n  const pager: FieryPager =\n  {\n    index: 0,\n\n    hasQuery(): boolean\n    {\n      return !!(entry.query && entry.requery)\n    },\n\n    hasData(): boolean\n    {\n      const target = entry.target\n\n      if (isArray(target))\n      {\n        return target.length > 0\n      }\n\n      if (isObject(target))\n      {\n        for (let prop in target)\n        {\n          return true\n        }\n      }\n\n      return false\n    },\n\n    hasNext(): boolean\n    {\n      return this.hasQuery() && this.hasData()\n    },\n\n    hasPrev(): boolean\n    {\n      return this.hasQuery() && this.index > 0\n    },\n\n    next(): Promise<FieryTarget>\n    {\n      const { query, requery, last, first, off } = entry\n\n      if (query && requery && last && this.hasData())\n      {\n        if (off) off()\n\n        delete entry.off\n        delete entry.last\n\n        this.index++\n        pointer = first\n\n        requery(query.startAfter(last))\n\n        if (entry.promise) return entry.promise\n      }\n\n      return Promise.reject('The pager could not execute next')\n    },\n\n    prev(): Promise<FieryTarget>\n    {\n      const { query, requery, first, off } = entry\n\n      if (query && requery && (first || pointer) && this.index > 0)\n      {\n        if (off) off()\n\n        delete entry.off\n\n        this.index--\n\n        if (first)\n        {\n          delete entry.first\n\n          requery(query.endBefore(first))\n        }\n        else\n        {\n          requery(query.startAt(pointer))\n\n          pointer = undefined\n        }\n\n        if (entry.promise) return entry.promise\n      }\n\n      return Promise.reject('The pager could not execute prev')\n    }\n  }\n\n  return pager\n}\n","\nimport * as firebase from 'firebase'\n\n\n\nimport { PROP_UID } from '../constants'\nimport { FierySystem, FieryEntry, FieryTarget, FieryData, FieryOptions, FieryMap, FieryCacheEntry } from '../types'\nimport { forEach } from '../util'\nimport { refreshData } from '../data'\nimport { getCacheForDocument, removeDataFromEntry, removeCacheFromEntry, destroyCache } from '../cache'\nimport { stats } from '../stats'\nimport { updatePointers, getChanges } from '../entry'\nimport { callbacks } from '../callbacks'\n\n\n\ntype OnSnapshot = (querySnapshot: firebase.firestore.QuerySnapshot) => any\ntype OnResolve = (target: FieryTarget) => any\ntype OnReject = (reason: any) => any\n\n\n\nfunction factory (entry: FieryEntry): FieryMap\n{\n  type CollectionQuery = firebase.firestore.CollectionReference | firebase.firestore.Query\n  const options: FieryOptions = entry.options\n  const query: CollectionQuery = (options.query\n    ? options.query(entry.source as firebase.firestore.CollectionReference)\n    : entry.source) as CollectionQuery\n\n  entry.requery = (query) =>\n  {\n    const initial = getInitialHandler(entry)\n\n    if (!entry.target)\n    {\n      entry.target = options.newCollection()\n    }\n\n    stats.queries++\n\n    if (options.once)\n    {\n      entry.promise = query.get(options.onceOptions)\n        .then(initial)\n        .catch(options.onError)\n    }\n    else\n    {\n      let resolve: OnResolve = () => {}\n      let reject: OnReject = () => {}\n\n      entry.promise = new Promise<FieryTarget>((_resolve, _reject) => {\n        resolve = _resolve\n        reject = _reject\n      })\n\n      entry.off = query.onSnapshot(\n        options.liveOptions,\n        getLiveHandler(entry, initial, resolve),\n        (reason) => {\n          reject(reason)\n          options.onError(reason)\n        }\n      )\n    }\n  }\n\n  entry.requery(entry.query = query)\n\n  return entry.target as FieryMap\n}\n\nfunction getInitialHandler (entry: FieryEntry): OnSnapshot\n{\n  const options: FieryOptions = entry.options\n  const system: FierySystem = entry.instance.system\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    const target: FieryMap = entry.target as FieryMap\n    const missing: FieryMap = { ...target }\n\n    options.onMutate(() =>\n    {\n      querySnapshot.forEach((doc: firebase.firestore.DocumentSnapshot) =>\n      {\n        const cache: FieryCacheEntry = getCacheForDocument(entry, doc, true)\n\n        refreshData(cache, doc, entry)\n\n        system.setProperty(target, doc.id, cache.data)\n\n        delete missing[doc.id]\n\n        callbacks.onCollectionAdd(cache.data, target, entry)\n\n      }, options.onError)\n\n      forEach(missing, (missed, key) => system.removeProperty(target, key as string))\n\n      return target\n    })\n\n    forEach(missing, data =>\n    {\n      callbacks.onCollectionRemove(data, target, entry)\n\n      removeDataFromEntry(entry, data)\n    })\n\n    options.onSuccess(target)\n\n    updatePointers(entry, querySnapshot)\n\n    callbacks.onCollectionChanged(target, entry)\n\n    return target\n  }\n}\n\nfunction getUpdateHandler (entry: FieryEntry): OnSnapshot\n{\n  const options: FieryOptions = entry.options\n  const system: FierySystem = entry.instance.system\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    const target: FieryMap = entry.target as FieryMap\n\n    options.onMutate(() =>\n    {\n      const changes = getChanges(querySnapshot)\n\n      changes.forEach((change: firebase.firestore.DocumentChange) =>\n      {\n        const doc: firebase.firestore.DocumentSnapshot = change.doc\n        const cache: FieryCacheEntry = getCacheForDocument(entry, doc)\n\n        switch (change.type)\n        {\n          case 'modified':\n            const updated: FieryData = refreshData(cache, doc, entry)\n            system.setProperty(target, doc.id, updated)\n\n            callbacks.onCollectionModify(updated, target, entry)\n            break\n\n          case 'added':\n            const created: FieryData = refreshData(cache, doc, entry)\n            system.setProperty(target, doc.id, created)\n\n            callbacks.onCollectionAdd(created, target, entry)\n            break\n\n          case 'removed':\n            callbacks.onCollectionRemove(cache.data, target, entry)\n\n            system.removeProperty(target, doc.id)\n\n            if (doc.exists)\n            {\n              removeCacheFromEntry(entry, cache)\n            }\n            else\n            {\n              if (options.propExists)\n              {\n                system.setProperty(cache.data, options.propExists, false)\n              }\n\n              cache.exists = false\n              destroyCache(cache)\n            }\n            break\n        }\n      }, options.onError)\n\n      return target\n    })\n\n    options.onSuccess(target)\n\n    updatePointers(entry, querySnapshot)\n\n    callbacks.onCollectionChanged(target, entry)\n  }\n}\n\nfunction getLiveHandler (entry: FieryEntry, handleInitial: OnSnapshot, resolve: OnResolve): OnSnapshot\n{\n  const handleUpdate: OnSnapshot = getUpdateHandler(entry)\n  let handler: OnSnapshot = handleInitial\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    handler(querySnapshot)\n    resolve(entry.target as FieryTarget)\n    handler = handleUpdate\n  }\n}\n\nexport default factory\n","\nimport * as firebase from 'firebase'\n\n\nimport { PROP_UID } from '../constants'\nimport { FierySystem, FieryEntry, FieryTarget, FieryData, FieryOptions, FieryMap, FieryCacheEntry } from '../types'\nimport { refreshData } from '../data'\nimport { getCacheForDocument, removeCacheFromEntry, removeDataFromEntry, destroyCache } from '../cache'\nimport { forEach } from '../util'\nimport { updatePointers, getChanges } from '../entry'\nimport { stats } from '../stats'\nimport { callbacks } from '../callbacks'\n\n\n\ntype OnSnapshot = (querySnapshot: firebase.firestore.QuerySnapshot) => any\ntype OnResolve = (target: FieryTarget) => any\ntype OnReject = (reason: any) => any\n\n\nexport function factory (entry: FieryEntry): FieryData[]\n{\n  type CollectionQuery = firebase.firestore.CollectionReference | firebase.firestore.Query\n  const options: FieryOptions = entry.options\n  const query: CollectionQuery = (options.query\n    ? options.query(entry.source as firebase.firestore.CollectionReference)\n    : entry.source) as CollectionQuery\n\n  entry.requery = (query) =>\n  {\n    const initial = getInitialHandler(entry)\n\n    if (!entry.target)\n    {\n      entry.target = options.newCollection()\n    }\n\n    stats.queries++\n\n    if (options.once)\n    {\n      entry.promise = query.get(options.onceOptions)\n        .then(initial)\n        .catch(options.onError)\n    }\n    else\n    {\n      let resolve: OnResolve = () => {}\n      let reject: OnReject = () => {}\n\n      entry.promise = new Promise<FieryTarget>((_resolve, _reject) => {\n        resolve = _resolve\n        reject = _reject\n      })\n\n      entry.off = query.onSnapshot(\n        options.liveOptions,\n        getLiveHandler(entry, initial, resolve),\n        (reason) => {\n          reject(reason)\n          options.onError(reason)\n        }\n      )\n    }\n  }\n\n  entry.requery(entry.query = query)\n\n  return entry.target as FieryData[]\n}\n\nfunction getInitialHandler (entry: FieryEntry): OnSnapshot\n{\n  const options: FieryOptions = entry.options\n  const system: FierySystem = entry.instance.system\n  const initialTarget: FieryTarget | undefined = entry.target\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    const target: FieryData[] = entry.target as FieryData[]\n    const missing: FieryMap = {}\n\n    if (initialTarget)\n    {\n      for (let i = 0; i < target.length; i++)\n      {\n        const data = target[i]\n        missing[data[PROP_UID]] = data\n      }\n    }\n\n    options.onMutate(() =>\n    {\n        system.arrayResize(target, 0)\n\n        querySnapshot.forEach((doc: firebase.firestore.DocumentSnapshot) =>\n        {\n          const cache: FieryCacheEntry = getCacheForDocument(entry, doc, true)\n\n          refreshData(cache, doc, entry)\n\n          system.arrayAdd(target, cache.data)\n\n          delete missing[cache.uid]\n\n          callbacks.onCollectionAdd(cache.data, target, entry)\n\n        }, options.onError)\n\n        return target\n    })\n\n    forEach(missing, data =>\n    {\n      callbacks.onCollectionRemove(data, target, entry)\n\n      removeDataFromEntry(entry, data)\n    })\n\n    options.onSuccess(target)\n\n    updatePointers(entry, querySnapshot)\n\n    callbacks.onCollectionChanged(target, entry)\n\n    return target\n  }\n}\n\nfunction getUpdateHandler (entry: FieryEntry): OnSnapshot\n{\n  const options: FieryOptions = entry.options\n  const system: FierySystem = entry.instance.system\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    const target: FieryData[] = entry.target as FieryData[]\n\n    options.onMutate(() =>\n    {\n      const changes = getChanges(querySnapshot)\n\n      changes.forEach((change: firebase.firestore.DocumentChange) =>\n      {\n        const doc: firebase.firestore.DocumentSnapshot = change.doc\n        const cache: FieryCacheEntry = getCacheForDocument(entry, doc)\n\n        switch (change.type)\n        {\n          case 'added':\n            const created: FieryData = refreshData(cache, doc, entry)\n            system.arraySet(target, change.newIndex, created)\n\n            callbacks.onCollectionAdd(created, target, entry)\n            break\n\n          case 'removed':\n            callbacks.onCollectionRemove(cache.data, target, entry)\n\n            if (doc.exists)\n            {\n              removeCacheFromEntry(entry, cache)\n            }\n            else\n            {\n              if (options.propExists)\n              {\n                system.setProperty(cache.data, options.propExists, false)\n              }\n\n              cache.exists = false\n              destroyCache(cache)\n            }\n            break\n\n          case 'modified':\n            const updated: FieryData = refreshData(cache, doc, entry)\n\n            if (change.oldIndex !== change.newIndex)\n            {\n              system.arraySet(target, change.newIndex, updated)\n            }\n\n            callbacks.onCollectionModify(updated, target, entry)\n            break\n        }\n      }, options.onError)\n\n      system.arrayResize(target, querySnapshot.size)\n\n      return target\n    })\n\n    options.onSuccess(target)\n\n    updatePointers(entry, querySnapshot)\n\n    callbacks.onCollectionChanged(target, entry)\n  }\n}\n\nfunction getLiveHandler (entry: FieryEntry, handleInitial: OnSnapshot, resolve: OnResolve): OnSnapshot\n{\n  const handleUpdate: OnSnapshot = getUpdateHandler(entry)\n  let handler: OnSnapshot = handleInitial\n\n  return (querySnapshot: firebase.firestore.QuerySnapshot) =>\n  {\n    handler(querySnapshot)\n    resolve(entry.target as FieryTarget)\n    handler = handleUpdate\n  }\n}\n\nexport default factory\n"],"sourceRoot":""}